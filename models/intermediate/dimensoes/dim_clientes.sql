{{config(materialized='table')}}

WITH fonte_clientes AS (

    SELECT 
        CAST(ID_CLIENTES AS NUMBER) AS ID_CLIENTES,
        CAST(NOME_CLIENTE AS VARCHAR) AS NOME_CLIENTE,
        CAST(ENDERECO AS VARCHAR) AS ENDERECO,
        CAST(ID_CONCESSIONARIAS AS NUMBER) AS ID_CONCESSIONARIAS,
        TO_CHAR(DATA_INCLUSAO, 'YYYY-MM-DD HH24:MI') AS DATA_INCLUSAO,
        TO_CHAR(DATA_ATUALIZACAO, 'YYYY-MM-DD HH24:MI') AS DATA_ATUALIZACAO
    FROM {{ref("stg_clientes")}}

)

SELECT 
    ID_CLIENTES,
    NOME_CLIENTE,
    ENDERECO,
    ID_CONCESSIONARIAS,
    DATA_INCLUSAO,
    DATA_ATUALIZACAO
FROM fonte_clientes