{{config(materialized='table')}}

WITH dim_vendedores AS(

    SELECT
        CAST(ID_VENDEDORES AS NUMBER) AS ID_VENDEDORES,
        CAST(NOME_VENDEDOR AS VARCHAR) AS NOME_VENDEDOR,
        CAST(ID_CONCESSIONARIAS AS NUMBER) AS ID_CONCESSIONARIAS,
        TO_CHAR(DATA_INCLUSAO,'YYYY-MM-DD HH24:MI') AS DATA_INCLUSAO,
        TO_CHAR(DATA_ATUALIZACAO, 'YYYY-MM-DD HH24:MI') AS DATA_ATUALIZACAO
    FROM {{ref('stg_vendedores')}}

)

SELECT 
    ID_VENDEDORES,
    NOME_VENDEDOR,
    ID_CONCESSIONARIAS,
    DATA_INCLUSAO,
    DATA_ATUALIZACAO
FROM dim_vendedores