{{config(materialized = 'table')}}

WITH dim_cidades AS(
    
    SELECT 
        CAST(ID_CIDADES AS NUMBER) AS ID_CIDADES,
        CAST(NOME_CIDADE AS VARCHAR) AS NOME_CIDADE,
        CAST(ID_ESTADOS AS NUMBER) AS ID_ESTADOS,
        TO_CHAR(DATA_INCLUSAO, 'YYYY-MM-DD HH24:MI') AS DATA_INCLUSAO,
        TO_CHAR(DATA_ATUALIZACAO, 'YYYY-MM-DD HH24:MI') AS DATA_ATUALIZACAO
    FROM {{ref("stg_cidades")}}

)

SELECT 
    ID_CIDADES,
    NOME_CIDADE,
    ID_ESTADOS,
    DATA_INCLUSAO,
    DATA_ATUALIZACAO
FROM dim_cidades