{{config(materialized='table')}}

WITH dim_concessionarias AS (

    SELECT 
        CAST(ID_CONCESSIONARIAS AS NUMBER) AS ID_CONCESSIONARIAS,
        CAST(NOME_CONCESSIONARIA AS VARCHAR) AS NOME_CONCESSIONARIA,
        CAST(ID_CIDADES AS NUMBER) AS ID_CIDADES,
        TO_CHAR(DATA_INCLUSAO, 'YYYY-MM-DD HH24:MI') AS DATA_INCLUSAO,
        TO_CHAR(DATA_ATUALIZACAO, 'YYYY-MM-DD HH24:MI') AS DATA_ATUALIZACAO
    FROM {{ref("stg_concessionarias")}}

)

SELECT 
    ID_CONCESSIONARIAS,
    NOME_CONCESSIONARIA,
    ID_CIDADES,
    DATA_INCLUSAO,
    DATA_ATUALIZACAO
FROM dim_concessionarias