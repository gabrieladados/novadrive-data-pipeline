{{config(materialized='table')}}

WITH dim_veiculos AS (

    SELECT 
        CAST(ID_VEICULOS AS NUMBER) AS ID_VEICULOS,
        CAST(NOME_VEICULO AS VARCHAR) AS NOME_VEICULO,
        CAST(TIPO_VEICULO AS VARCHAR) AS TIPO_VEICULO,
        CAST(VALOR_VEICULO AS DECIMAL(10,2)) AS VALOR_VEICULO,
        TO_CHAR(DATA_INCLUSAO,'YYYY-MM-DD HH24:MI') AS DATA_INCLUSAO,
        TO_CHAR(DATA_ATUALIZACAO, 'YYYY-MM-DD HH24:MI') AS DATA_ATUALIZACAO
    FROM {{ref('stg_veiculos')}}

)

SELECT 
    ID_VEICULOS,
    NOME_VEICULO,
    TIPO_VEICULO,
    VALOR_VEICULO,
    DATA_INCLUSAO,
    DATA_ATUALIZACAO
FROM dim_veiculos