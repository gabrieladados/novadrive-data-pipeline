{{config(materialized='table')}}

WITH fato_vendas AS(

    SELECT 
        CAST(ID_VENDAS AS NUMBER) AS ID_VENDAS,
        CAST(ID_VEICULOS AS NUMBER) AS ID_VEICULOS,
        CAST(ID_CONCESSIONARIAS AS NUMBER) AS ID_CONCESSIONARIAS,
        CAST(ID_VENDEDORES AS NUMBER) AS ID_VENDEDORES,
        CAST(ID_CLIENTES AS NUMBER) AS ID_CLIENTES,
        CAST(VALOR_PAGO AS DECIMAL(10,2)) AS VALOR_PAGO,
        DATA_VENDA,
        DATA_INCLUSAO,
        DATA_ATUALIZACAO
    FROM {{ref('stg_vendas')}}
)

SELECT 
    ID_VENDAS,
    ID_VEICULOS,
    ID_CONCESSIONARIAS,
    ID_VENDEDORES,
    ID_CLIENTES,
    VALOR_PAGO,
    DATA_VENDA,
    DATA_INCLUSAO,
    DATA_ATUALIZACAO
FROM fato_vendas